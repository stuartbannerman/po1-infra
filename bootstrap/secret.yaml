# apiVersion: v1
# kind: Secret
# metadata:
#     name: argocd-helm-registry
#     namespace: argocd
#     labels:
#         argocd.argoproj.io/secret-type: repository
# stringData:
#     type: helm
#     project: po1
#     url: 236731556556.dkr.ecr.eu-west-1.amazonaws.com/
#     password: password
#     username: username
# ---
# apiVersion: v1
# kind: Secret
# metadata:
#   name: argocd-github-pat
#   namespace: argocd
#   labels:
#     argocd.argoproj.io/secret-type: repo-creds
# stringData:
#   type: git
#   url: https://github.com/travcorp
#   username: blank
#   password: blank
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: externalsecret-argocd
  namespace: argocd
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: externalsecret-secretsmanager
    kind: ClusterSecretStore
  target:
    # The name of the K8 secret to put the secret in
    name: argocd-github-pat

    template:
      engineVersion: v2
      stringData:
        type: git
        url: https://github.com/travcorp
        username: blank
        password: "{{ .password }}"





    # creationPolicy: Merge
    # creationPolicy: Owner
    # deletionPolicy: Retain
  data:
  - secretKey: password # local name
    remoteRef:
      key: po1-k8 # AWS Secrets Manager secret name
      property: github-pat # AWS Secrets Manager secret key